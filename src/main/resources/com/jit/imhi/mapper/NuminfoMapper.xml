<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.jit.imhi.mapper.NuminfoMapper">
    <resultMap id="BaseResultMap" type="com.jit.imhi.model.Numinfo">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Thu Jan 18 17:22:04 CST 2018.
        -->
        <id column="user_id" property="userId" jdbcType="INTEGER"/>
        <id column="friend_id" property="friendId" jdbcType="INTEGER"/>
        <id column="friend_type" property="friendType" jdbcType="VARCHAR"/>
        <result column="new_id" property="newId" jdbcType="INTEGER"/>
        <result column="old_id" property="oldId" jdbcType="INTEGER"/>
    </resultMap>
    <delete id="deleteByPrimaryKey" parameterType="map">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Thu Jan 18 17:22:04 CST 2018.
        -->
        delete from NumInfo
        where user_id = #{userId,jdbcType=INTEGER}
        and friend_id = #{friendId,jdbcType=INTEGER}
        and friend_type = #{friendType,jdbcType=VARCHAR}
    </delete>
    <insert id="insert" parameterType="com.jit.imhi.model.Numinfo">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Thu Jan 18 17:22:04 CST 2018.
        -->
        insert into NumInfo (user_id, friend_id, friend_type,
        new_id)
        values (#{userId,jdbcType=INTEGER}, #{friendId,jdbcType=INTEGER}, #{friendType,jdbcType=VARCHAR},
        #{newId,jdbcType=INTEGER})
    </insert>
    <update id="updateByPrimaryKey" parameterType="com.jit.imhi.model.Numinfo">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Thu Jan 18 17:22:04 CST 2018.
        -->
        update NumInfo
        set new_id = #{newId,jdbcType=INTEGER},
        old_id = #{oldId,jdbcType=INTEGER}
        where user_id = #{userId,jdbcType=INTEGER}
        and friend_id = #{friendId,jdbcType=INTEGER}
        and friend_type = #{friendType,jdbcType=VARCHAR}
    </update>
    <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="map">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Thu Jan 18 17:22:04 CST 2018.
        -->
        select user_id, friend_id, friend_type, new_id, old_id
        from NumInfo
        where user_id = #{userId,jdbcType=INTEGER}
        and friend_id = #{friendId,jdbcType=INTEGER}
        and friend_type = #{friendType,jdbcType=VARCHAR}
    </select>
    <select id="selectAll" resultMap="BaseResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Thu Jan 18 17:22:04 CST 2018.
        -->
        select user_id, friend_id, friend_type, new_id, old_id
        from NumInfo
    </select>


    <!--yuyisummer 1.18 20.25 -->
    <select id="selectAllBy" resultMap="BaseResultMap" parameterType="map">
    select user_id, friend_id, friend_type, new_id, old_id
    from NumInfo
    where user_id = #{userId,jdbcType=INTEGER}
    and friend_id = #{friendId,jdbcType=INTEGER}
     and friend_type = #{friendType,jdbcType=VARCHAR}
     and new_id != old_id
  </select>

    <!--yuyisummer 1.19   List<String> selectForMap();-->

    <select id="selectForMap" parameterType="java.util.HashMap" resultType="java.util.Map">
    select user_id
    from NumInfo
  </select>
    <!--yuyisummer 1.19   int updateNoneOld(Numinfo record); ;-->
    <update id="updateNoneOld" parameterType="com.jit.imhi.model.Numinfo">
    update NumInfo
    set new_id = #{newId,jdbcType=INTEGER}
    where user_id = #{userId,jdbcType=INTEGER}
    and friend_id = #{friendId,jdbcType=INTEGER}
    and friend_type = #{friendType,jdbcType=VARCHAR}
  </update>

    <!--yuyisummer 1.20 23.15 表中查找普通等信息,也可以用来查找拒绝消息-->
    <select id="selectNumOne" resultType="java.lang.String" parameterType="com.jit.imhi.model.Numinfo">
    select MAX(new_id)
    from NumInfo
    where user_id = #{userId,jdbcType=INTEGER}
    and friend_id = #{friendId,jdbcType=INTEGER}
    and friend_type = #{friendType,jdbcType=VARCHAR}
  </select>
    <!--yuyisummer 1.20 23.21 表中查找群消息-->
    <select id="selectNumTwo" resultType="java.lang.String" parameterType="com.jit.imhi.model.Numinfo">
    select MAX(new_id)
    from NumInfo
    where  user_id = #{userId,jdbcType=INTEGER}
    and friend_type = #{friendType,jdbcType=VARCHAR}
  </select>


    <!--yuyisummer 1.29 20.25 -->
    <select id="selectGroupInfo"  resultMap="BaseResultMap" >

            select user_id, friend_id, friend_type, new_id, old_id
            from NumInfo
            where user_id = #{userId,jdbcType=INTEGER}
            and friend_type = #{friendType,jdbcType=VARCHAR}

    </select>
    <update id="updateGroupOld" parameterType="com.jit.imhi.model.Numinfo">
        update NumInfo
        set new_id = #{newId,jdbcType=INTEGER} ,
        friend_id = #{friendId,jdbcType=INTEGER}
        where user_id = #{userId,jdbcType=INTEGER}
        and friend_type = #{friendType,jdbcType=VARCHAR}
    </update>


</mapper>